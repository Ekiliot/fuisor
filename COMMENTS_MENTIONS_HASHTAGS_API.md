# üí¨ Comment Replies, User Mentions & Hashtags API

## üöÄ **–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã!**

–¢–µ–ø–µ—Ä—å –≤–∞—à API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- ‚úÖ **–û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** (nested comments)
- ‚úÖ **–¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** (@username)
- ‚úÖ **–•–µ—à—Ç–µ–≥–∏** (#hashtag)

---

## üí¨ **–û–¢–í–ï–¢–´ –ù–ê –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò**

### **POST** `/api/posts/:id/comments`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏–ª–∏ –æ—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `content` | string | ‚úÖ | –¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è |
| `parent_comment_id` | UUID | ‚ùå | ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤) |

#### **–ü—Ä–∏–º–µ—Ä—ã:**

**–û–±—ã—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:**
```json
{
  "content": "–û—Ç–ª–∏—á–Ω—ã–π –ø–æ—Å—Ç!"
}
```

**–û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:**
```json
{
  "content": "–°–æ–≥–ª–∞—Å–µ–Ω!",
  "parent_comment_id": "uuid-parent-comment"
}
```

#### **–û—Ç–≤–µ—Ç:**
```json
{
  "id": "uuid",
  "content": "–û—Ç–ª–∏—á–Ω—ã–π –ø–æ—Å—Ç!",
  "parent_comment_id": null,
  "created_at": "2025-10-22T16:30:00Z",
  "profiles": {
    "username": "user123",
    "avatar_url": "https://..."
  }
}
```

---

## üë• **–¢–ï–ì–ò–†–û–í–ê–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô**

### **POST** `/api/posts`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç —Å —Ç–µ–≥–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `mentions` | array | ‚ùå | –ú–∞—Å—Å–∏–≤ username –¥–ª—è —Ç–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |

#### **–ü—Ä–∏–º–µ—Ä:**
```json
{
  "caption": "–û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å —Å @friend1 –∏ @friend2!",
  "mentions": ["friend1", "friend2"],
  "media_type": "image"
}
```

#### **–ù–æ–≤—ã–µ endpoints:**

**GET** `/api/posts/mentions` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç—ã, –≥–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–ø–æ–º—è–Ω—É—Ç
- –¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å—Ç—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

---

## #Ô∏è‚É£ **–•–ï–®–¢–ï–ì–ò**

### **POST** `/api/posts`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç —Å —Ö–µ—à—Ç–µ–≥–∞–º–∏

#### **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `hashtags` | array | ‚ùå | –ú–∞—Å—Å–∏–≤ —Ö–µ—à—Ç–µ–≥–æ–≤ (–±–µ–∑ #) |

#### **–ü—Ä–∏–º–µ—Ä:**
```json
{
  "caption": "–ö—Ä–∞—Å–∏–≤—ã–π –∑–∞–∫–∞—Ç!",
  "hashtags": ["sunset", "nature", "photography"],
  "media_type": "image"
}
```

#### **–ù–æ–≤—ã–µ endpoints:**

**GET** `/api/posts/hashtag/:hashtag` - –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å—Ç—ã –ø–æ —Ö–µ—à—Ç–µ–≥—É
- –ü—É–±–ª–∏—á–Ω—ã–π endpoint
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å—Ç—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –•–µ—à—Ç–µ–≥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É

---

## üìä **–°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•**

### **–ù–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

#### **`post_mentions`**
```sql
- id (UUID, PK)
- post_id (UUID, FK to posts)
- mentioned_user_id (UUID, FK to profiles)
- created_at (TIMESTAMPTZ)
```

#### **`hashtags`**
```sql
- id (UUID, PK)
- name (TEXT, UNIQUE)
- created_at (TIMESTAMPTZ)
```

#### **`post_hashtags`**
```sql
- id (UUID, PK)
- post_id (UUID, FK to posts)
- hashtag_id (UUID, FK to hashtags)
- created_at (TIMESTAMPTZ)
```

#### **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `comments`:**
```sql
- parent_comment_id (UUID, FK to comments) - –ù–û–í–û–ï –ü–û–õ–ï
```

---

## üß™ **–ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø**

### **–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —Å —Ç–µ–≥–∞–º–∏ –∏ —Ö–µ—à—Ç–µ–≥–∞–º–∏:**

```bash
curl -X POST http://localhost:3000/api/posts \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -F "media=@photo.jpg" \
  -F "caption=–û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å —Å –¥—Ä—É–∑—å—è–º–∏! #fun #friends" \
  -F "mentions=[\"friend1\", \"friend2\"]" \
  -F "hashtags=[\"fun\", \"friends\", \"summer\"]"
```

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:**

```bash
curl -X POST http://localhost:3000/api/posts/POST_ID/comments \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "content": "–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—Å–µ–Ω!",
    "parent_comment_id": "COMMENT_ID"
  }'
```

### **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ –ø–æ —Ö–µ—à—Ç–µ–≥—É:**

```bash
curl http://localhost:3000/api/posts/hashtag/fun?page=1&limit=10
```

### **–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏:**

```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  http://localhost:3000/api/posts/mentions?page=1&limit=10
```

---

## üîß **–ú–ò–ì–†–ê–¶–ò–Ø –ë–ê–ó–´ –î–ê–ù–ù–´–•**

–î–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ Supabase SQL Editor:

```sql
-- –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:
-- supabase/migration_add_replies_mentions_hashtags.sql
```

---

## üéØ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê**

### **–ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å Instagram API:**

| –§—É–Ω–∫—Ü–∏—è | –ù–∞—à API | Instagram API |
|---------|---------|---------------|
| **–û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚ùå –ù–µ—Ç |
| **–¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø–æ—Å—Ç–∞—Ö** | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚ùå –ù–µ—Ç |
| **–•–µ—à—Ç–µ–≥–∏** | ‚úÖ –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ | ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è |
| **–ü–æ–∏—Å–∫ –ø–æ —Ö–µ—à—Ç–µ–≥–∞–º** | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |
| **–£–ø–æ–º–∏–Ω–∞–Ω–∏—è** | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚ùå –ù–µ—Ç |

---

## üöÄ **–°–¢–ê–¢–£–°**

‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã.

**–í–∞—à API —Ç–µ–ø–µ—Ä—å –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç Instagram –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏!** üéâ
